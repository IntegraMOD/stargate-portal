Stargate Redirect Mod copyright 30 December 2007 Michaelo 2007

The following changes will cause pages to redirect to portal page after login/logout.
Note, if you login from the index page you will be redirected to the index page.


Files to edit:
ucp.php
includes/functions.php



#
#-----[ OPEN ]------------------------------------------
#

includes/functions.php

#
#-----[ FIND ]------------------------------------------
#
	else if ($url === "{$phpbb_root_path}index.$phpEx")
	{
		return append_sid("{$phpbb_root_path}index.$phpEx");
	}

#
#-----[ AFTER, ADD ]------------------------------------------
#
	if ($url === "portal.$phpEx")
	{
		return append_sid("portal.$phpEx");
	}
	else if ($url === "{$phpbb_root_path}portal.$phpEx")
	{
		return append_sid("{$phpbb_root_path}portal.$phpEx");
	}

#
#-----[ FIND ]------------------------------------------
#

			$redirect = request_var('redirect', "{$phpbb_root_path}index.$phpEx");

#
#-----[ REPLACE, WITH ]------------------------------------------
#

			// Redirect to portal after login
			if(STARGATE)
			{
				$redirect = request_var('redirect', "{$phpbb_root_path}portal.$phpEx");
			}
			else
				$redirect = request_var('redirect', "{$phpbb_root_path}index.$phpEx");

#
#-----[ FIND ]------------------------------------------
#

		'U_INDEX'				=> append_sid("{$phpbb_root_path}index.$phpEx"),

#
#-----[ AFTER, ADD ]------------------------------------------
#

		'U_PORTAL'				=> append_sid("{$phpbb_root_path}portal.$phpEx"),


#
#-----[ OPEN ]------------------------------------------
#

ucp.php

#
#-----[ FIND ]------------------------------------------
#

		meta_refresh(3, append_sid("{$phpbb_root_path}index.$phpEx"));

#
#-----[ REPLACE, WITH ]------------------------------------------
#

		if(STARGATE)
		{
			meta_refresh(3, append_sid("{$phpbb_root_path}portal.$phpEx"));
		}
		else
			meta_refresh(3, append_sid("{$phpbb_root_path}index.$phpEx"));

#
#-----[ FIND ]------------------------------------------
#

		$message = $message . '<br /><br />' . sprintf($user->lang['RETURN_INDEX'], '<a href="' . append_sid("{$phpbb_root_path}index.$phpEx") . '">', '</a> ');

#
#-----[ REPLACE, WITH ]------------------------------------------
#

		if(STARGATE)
		{
			$message = $message . '<br /><br />' . sprintf($user->lang['RETURN_PORTAL'], '<a href="' . append_sid("{$phpbb_root_path}portal.$phpEx") . '">', '</a> ');
		}
		else
			$message = $message . '<br /><br />' . sprintf($user->lang['RETURN_INDEX'], '<a href="' . append_sid("{$phpbb_root_path}index.$phpEx") . '">', '</a> ');


Save changes.
#EOM